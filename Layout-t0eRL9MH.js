const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["strapi-DtqVexM2.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{r as h,a4 as v,cm as _,a7 as I,n as T,cn as D,bj as A,_ as B,a as M,b as C,aA as O,bD as U,j as t,co as d,b8 as F,cp as R,k as G,a6 as H,aw as K,P as y,aB as V,B as $,cq as q}from"./strapi-DtqVexM2.js";import{s as W}from"./sortBy-Cuwzu7d8.js";import{s as z}from"./selectors-Dfbw-xCr.js";import"./_baseMap-CC6cVnmC.js";import"./_baseEach-KoNV177k.js";const J=i=>i.map(a=>{const o=a.links.map(n=>({...n,isDisplayed:!1}));return{...a,links:o}}),Q=()=>{const[{isLoading:i,menu:a},o]=h.useState({isLoading:!0,menu:[]}),n=v("useSettingsMenu",s=>s.checkUserHasPermissions),u=_("useSettingsMenu",s=>s.shouldUpdateStrapi),m=I("useSettingsMenu",s=>s.settings),g=T(z),P=h.useMemo(()=>D(),[]),{admin:p,global:r}=A(P,async()=>(await B(async()=>{const{SETTINGS_LINKS_EE:s}=await import("./strapi-DtqVexM2.js").then(e=>e.iP);return{SETTINGS_LINKS_EE:s}},__vite__mapDeps([0,1]))).SETTINGS_LINKS_EE(),{combine(s,e){return{admin:[...e.admin,...s.admin],global:[...s.global,...e.global]}},defaultValue:{admin:[],global:[]}}),l=h.useCallback(s=>{if(!s.id)throw new Error("The settings menu item must have an id attribute.");return{...s,permissions:g.settings?.[s.id]?.main??[]}},[g.settings]);return h.useEffect(()=>{const s=async()=>{const E=await(L=>Promise.all(L.reduce((f,S,x)=>{const k=S.links.map(async(j,b)=>({hasPermission:(await n(j.permissions)).length>0,sectionIndex:x,linkIndex:b}));return[...f,...k]},[])))(w);o(L=>({...L,isLoading:!1,menu:w.map((f,S)=>({...f,links:f.links.map((x,k)=>{const j=E.find(b=>b.sectionIndex===S&&b.linkIndex===k);return{...x,isDisplayed:!!j?.hasPermission}})}))}))},{global:e,...N}=m,w=J([{...e,links:W([...e.links,...r.map(l)],c=>c.id).map(c=>({...c,hasNotification:c.id==="000-application-infos"&&u}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:p.map(l)},...Object.values(N)]);s()},[p,r,m,u,l,n]),{isLoading:i,menu:a.map(s=>({...s,links:s.links.filter(e=>e.isDisplayed)}))}},X=G(H)`
  border-radius: 50%;
  padding: ${({theme:i})=>i.spaces[2]};
  height: 2rem;
`,Y=({menu:i})=>{const{formatMessage:a}=M(),{trackUsage:o}=C(),{pathname:n}=O(),{license:u}=U(),m=u?.features.map(s=>s.name),g={"content-releases":"cms-content-releases","review-workflows":"review-workflows",sso:"sso",auditLogs:"audit-logs","auditLogs-purchase-page":"audit-logs"},p=i.filter(s=>!s.links.every(e=>e.isDisplayed===!1)).map(s=>({...s,title:s.intlLabel,links:s.links.map(e=>({...e,id:e.id,title:e.intlLabel,name:e.id}))})),r=a({id:"global.settings",defaultMessage:"Settings"}),l=s=>()=>{o("willNavigate",{from:n,to:s})};return t.jsxs(d.Main,{"aria-label":r,children:[t.jsx(d.Header,{label:r}),t.jsx(F,{background:"neutral150",marginBottom:5}),t.jsx(d.Sections,{children:p.map(s=>t.jsx(d.Section,{label:a(s.intlLabel),children:s.links.map(e=>t.jsx(d.Link,{to:e.to,onClick:l(e.to),label:a(e.intlLabel),endAction:t.jsxs(t.Fragment,{children:[e?.licenseOnly&&t.jsx(R,{fill:(m||[]).includes(g[e.id])?"primary600":"neutral300",width:"1.5rem",height:"1.5rem"}),e?.hasNotification&&t.jsx(X,{"aria-label":"Notification",backgroundColor:"primary600",textColor:"neutral0",children:"1"})]})},e.id))},s.id))})]})},is=()=>{const i=K("/settings/:settingId/*"),{formatMessage:a}=M(),{isLoading:o,menu:n}=Q();return o?t.jsx(y.Loading,{}):i?.params.settingId?t.jsxs($.Root,{sideNav:t.jsx(Y,{menu:n}),children:[t.jsx(y.Title,{children:a({id:"global.settings",defaultMessage:"Settings"})}),t.jsx(q,{})]}):t.jsx(V,{to:"application-infos"})};export{is as Layout};
